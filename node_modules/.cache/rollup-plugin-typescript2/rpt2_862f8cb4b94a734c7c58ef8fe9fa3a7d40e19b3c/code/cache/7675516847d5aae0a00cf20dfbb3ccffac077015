{"code":"import { __assign, __rest } from \"tslib\";\r\nimport React, { createContext, useContext } from 'react';\r\nimport { Button } from '@arco-design/web-react';\r\nimport { IconPlus, IconDelete, IconMenu, IconCaretDown, IconCaretUp, } from '@arco-design/web-react/icon';\r\nimport { useField, useFieldSchema } from '@formily/react';\r\nimport { isValid } from '@formily/shared';\r\nimport { SortableHandle } from 'react-sortable-hoc';\r\nimport cls from 'classnames';\r\nimport './index.scss';\r\nimport { usePrefixCls } from '../__builtins__';\r\nvar ArrayBaseContext = createContext(null);\r\nvar ItemContext = createContext(null);\r\nvar useArray = function () { return useContext(ArrayBaseContext); };\r\nvar useIndex = function (index) {\r\n    var ctx = useContext(ItemContext);\r\n    return ctx ? ctx.index : index !== null && index !== void 0 ? index : 0;\r\n};\r\nvar useRecord = function (record) {\r\n    var ctx = useContext(ItemContext);\r\n    return ctx ? ctx.record : record;\r\n};\r\nvar getDefaultValue = function (defaultValue, schema) {\r\n    var _a, _b, _c, _d, _e, _f, _g;\r\n    if (isValid(defaultValue))\r\n        return defaultValue;\r\n    if (Array.isArray(schema === null || schema === void 0 ? void 0 : schema.items))\r\n        return getDefaultValue(defaultValue, schema.items[0]);\r\n    if (((_a = schema === null || schema === void 0 ? void 0 : schema.items) === null || _a === void 0 ? void 0 : _a.type) === 'array')\r\n        return [];\r\n    if (((_b = schema === null || schema === void 0 ? void 0 : schema.items) === null || _b === void 0 ? void 0 : _b.type) === 'boolean')\r\n        return true;\r\n    if (((_c = schema === null || schema === void 0 ? void 0 : schema.items) === null || _c === void 0 ? void 0 : _c.type) === 'date')\r\n        return '';\r\n    if (((_d = schema === null || schema === void 0 ? void 0 : schema.items) === null || _d === void 0 ? void 0 : _d.type) === 'datetime')\r\n        return '';\r\n    if (((_e = schema === null || schema === void 0 ? void 0 : schema.items) === null || _e === void 0 ? void 0 : _e.type) === 'number')\r\n        return 0;\r\n    if (((_f = schema === null || schema === void 0 ? void 0 : schema.items) === null || _f === void 0 ? void 0 : _f.type) === 'object')\r\n        return {};\r\n    if (((_g = schema === null || schema === void 0 ? void 0 : schema.items) === null || _g === void 0 ? void 0 : _g.type) === 'string')\r\n        return '';\r\n    return null;\r\n};\r\nexport var ArrayBase = function (props) {\r\n    var field = useField();\r\n    var schema = useFieldSchema();\r\n    return (React.createElement(ArrayBaseContext.Provider, { value: { field: field, schema: schema, props: props } }, props.children));\r\n};\r\nArrayBase.Item = function (_a) {\r\n    var children = _a.children, props = __rest(_a, [\"children\"]);\r\n    return (React.createElement(ItemContext.Provider, { value: props }, children));\r\n};\r\nvar SortHandle = SortableHandle(function (props) {\r\n    var prefixCls = usePrefixCls('array-base');\r\n    return (React.createElement(IconMenu, __assign({}, props, { className: cls(\"\".concat(prefixCls, \"-sort-handle\"), props.className), style: __assign({}, props.style) })));\r\n});\r\nArrayBase.SortHandle = function (props) {\r\n    var _a;\r\n    var array = useArray();\r\n    if (!array)\r\n        return null;\r\n    if (((_a = array.field) === null || _a === void 0 ? void 0 : _a.pattern) !== 'editable')\r\n        return null;\r\n    return React.createElement(SortHandle, __assign({}, props));\r\n};\r\nvar Index = function (props) {\r\n    var _a;\r\n    var renderIndex = props.renderIndex;\r\n    var index = useIndex();\r\n    var prefixCls = usePrefixCls('array-base');\r\n    return (React.createElement(\"span\", __assign({}, props, { className: \"\".concat(prefixCls, \"-index\") }), (_a = renderIndex === null || renderIndex === void 0 ? void 0 : renderIndex(index)) !== null && _a !== void 0 ? _a : \"#\".concat(index + 1, \".\")));\r\n};\r\nArrayBase.Index = Index;\r\nvar Addition = function (props) {\r\n    var _a, _b, _c;\r\n    var self = useField();\r\n    var array = useArray();\r\n    var prefixCls = usePrefixCls('array-base');\r\n    if (!array)\r\n        return null;\r\n    if (((_a = array === null || array === void 0 ? void 0 : array.field) === null || _a === void 0 ? void 0 : _a.pattern) !== 'editable' &&\r\n        ((_b = array === null || array === void 0 ? void 0 : array.field) === null || _b === void 0 ? void 0 : _b.pattern) !== 'disabled') {\r\n        return null;\r\n    }\r\n    return (React.createElement(Button, __assign({ long: true }, props, { disabled: (_c = array === null || array === void 0 ? void 0 : array.field) === null || _c === void 0 ? void 0 : _c.disabled, className: cls(\"\".concat(prefixCls, \"-addition\"), props.className), onClick: function (e) {\r\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\r\n            if ((_a = array.props) === null || _a === void 0 ? void 0 : _a.disabled)\r\n                return;\r\n            var defaultValue = getDefaultValue(props.defaultValue, array.schema);\r\n            if (props.method === 'unshift') {\r\n                (_b = array === null || array === void 0 ? void 0 : array.field) === null || _b === void 0 ? void 0 : _b.unshift(defaultValue);\r\n                (_d = (_c = array.props) === null || _c === void 0 ? void 0 : _c.onAdd) === null || _d === void 0 ? void 0 : _d.call(_c, 0);\r\n            }\r\n            else {\r\n                (_f = (_e = array === null || array === void 0 ? void 0 : array.field) === null || _e === void 0 ? void 0 : _e.push) === null || _f === void 0 ? void 0 : _f.call(_e, defaultValue);\r\n                (_h = (_g = array.props) === null || _g === void 0 ? void 0 : _g.onAdd) === null || _h === void 0 ? void 0 : _h.call(_g, ((_k = (_j = array === null || array === void 0 ? void 0 : array.field) === null || _j === void 0 ? void 0 : _j.value) === null || _k === void 0 ? void 0 : _k.length) - 1);\r\n            }\r\n            (_l = props.onClick) === null || _l === void 0 ? void 0 : _l.call(props, e);\r\n        }, icon: React.createElement(IconPlus, null) }), self.title || props.title));\r\n};\r\nArrayBase.Addition = Addition;\r\nArrayBase.Remove = React.forwardRef(function (props, ref) {\r\n    var _a;\r\n    var index = useIndex();\r\n    var array = useArray();\r\n    var prefixCls = usePrefixCls('array-base');\r\n    if (!array)\r\n        return null;\r\n    if (((_a = array === null || array === void 0 ? void 0 : array.field) === null || _a === void 0 ? void 0 : _a.pattern) !== 'editable')\r\n        return null;\r\n    return (React.createElement(IconDelete, __assign({}, props, { className: cls(\"\".concat(prefixCls, \"-remove\"), props.className), ref: ref, onClick: function (e) {\r\n            var _a, _b, _c, _d, _e;\r\n            if ((_a = array.props) === null || _a === void 0 ? void 0 : _a.disabled)\r\n                return;\r\n            e.stopPropagation();\r\n            (_c = (_b = array.field) === null || _b === void 0 ? void 0 : _b.remove) === null || _c === void 0 ? void 0 : _c.call(_b, index);\r\n            (_e = (_d = array.props) === null || _d === void 0 ? void 0 : _d.onRemove) === null || _e === void 0 ? void 0 : _e.call(_d, index);\r\n            if (props.onClick) {\r\n                props.onClick(e);\r\n            }\r\n        } })));\r\n});\r\nArrayBase.MoveDown = React.forwardRef(function (props, ref) {\r\n    var _a;\r\n    var index = useIndex(props.index);\r\n    var array = useArray();\r\n    var prefixCls = usePrefixCls('array-base-move-down');\r\n    if (((_a = array === null || array === void 0 ? void 0 : array.field) === null || _a === void 0 ? void 0 : _a.pattern) !== 'editable')\r\n        return null;\r\n    return (React.createElement(IconCaretDown, __assign({}, props, { className: cls(prefixCls, props.className), ref: ref, onClick: function (e) {\r\n            var _a, _b, _c, _d, _e;\r\n            if ((_a = array.props) === null || _a === void 0 ? void 0 : _a.disabled)\r\n                return;\r\n            e.stopPropagation();\r\n            (_c = (_b = array.field) === null || _b === void 0 ? void 0 : _b.moveDown) === null || _c === void 0 ? void 0 : _c.call(_b, index);\r\n            (_e = (_d = array.props) === null || _d === void 0 ? void 0 : _d.onMoveDown) === null || _e === void 0 ? void 0 : _e.call(_d, index);\r\n            if (props.onClick) {\r\n                props.onClick(e);\r\n            }\r\n        } })));\r\n});\r\nArrayBase.MoveUp = React.forwardRef(function (props, ref) {\r\n    var _a;\r\n    var index = useIndex(props.index);\r\n    var array = useArray();\r\n    var prefixCls = usePrefixCls('array-base-move-up');\r\n    if (((_a = array === null || array === void 0 ? void 0 : array.field) === null || _a === void 0 ? void 0 : _a.pattern) !== 'editable')\r\n        return null;\r\n    return (React.createElement(IconCaretUp, __assign({}, props, { className: cls(prefixCls, props.className), ref: ref, onClick: function (e) {\r\n            var _a, _b, _c, _d;\r\n            if ((_a = array.props) === null || _a === void 0 ? void 0 : _a.disabled)\r\n                return;\r\n            e.stopPropagation();\r\n            (_b = array === null || array === void 0 ? void 0 : array.field) === null || _b === void 0 ? void 0 : _b.moveUp(index);\r\n            (_d = (_c = array === null || array === void 0 ? void 0 : array.props) === null || _c === void 0 ? void 0 : _c.onMoveUp) === null || _d === void 0 ? void 0 : _d.call(_c, index);\r\n            if (props.onClick) {\r\n                props.onClick(e);\r\n            }\r\n        } })));\r\n});\r\nArrayBase.useArray = useArray;\r\nArrayBase.useIndex = useIndex;\r\nArrayBase.useRecord = useRecord;\r\nArrayBase.mixin = function (target) {\r\n    target.Index = ArrayBase.Index;\r\n    target.SortHandle = ArrayBase.SortHandle;\r\n    target.Addition = ArrayBase.Addition;\r\n    target.Remove = ArrayBase.Remove;\r\n    target.MoveDown = ArrayBase.MoveDown;\r\n    target.MoveUp = ArrayBase.MoveUp;\r\n    target.useArray = ArrayBase.useArray;\r\n    target.useIndex = ArrayBase.useIndex;\r\n    target.useRecord = ArrayBase.useRecord;\r\n    return target;\r\n};\r\nexport default ArrayBase;\r\n//# sourceMappingURL=index.js.map","references":["H:/projects/formilyjs-arco/node_modules/@types/react/index.d.ts","H:/projects/formilyjs-arco/node_modules/@arco-design/web-react/es/index.d.ts","H:/projects/formilyjs-arco/node_modules/@arco-design/web-react/es/button/index.d.ts","H:/projects/formilyjs-arco/node_modules/@arco-design/web-react/icon/index.d.ts","H:/projects/formilyjs-arco/node_modules/@arco-design/web-react/icon/index.d.ts","H:/projects/formilyjs-arco/node_modules/@formily/react/esm/index.d.ts","H:/projects/formilyjs-arco/node_modules/@formily/core/esm/index.d.ts","H:/projects/formilyjs-arco/node_modules/@formily/shared/esm/index.d.ts","H:/projects/formilyjs-arco/node_modules/react-sortable-hoc/types/index.d.ts","H:/projects/formilyjs-arco/node_modules/classnames/index.d.ts","H:/projects/formilyjs-arco/packages/components/src/__builtins__/index.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/array-base/index.tsx\"],\"names\":[],\"mappings\":\";AAAA,OAAO,KAAK,EAAE,EAAE,aAAa,EAAE,UAAU,EAAE,MAAM,OAAO,CAAA;AACxD,OAAO,EAAE,MAAM,EAAE,MAAM,wBAAwB,CAAA;AAE/C,OAAO,EACL,QAAQ,EACR,UAAU,EACV,QAAQ,EACR,aAAa,EACb,WAAW,GACZ,MAAM,6BAA6B,CAAA;AAEpC,OAAO,EAAE,QAAQ,EAAE,cAAc,EAAwB,MAAM,gBAAgB,CAAA;AAE/E,OAAO,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AACzC,OAAO,EAAE,cAAc,EAAE,MAAM,oBAAoB,CAAA;AACnD,OAAO,GAAG,MAAM,YAAY,CAAA;AAE5B,OAAO,cAAc,CAAA;AACrB,OAAO,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAA;AAkD9C,IAAM,gBAAgB,GAAG,aAAa,CAAoB,IAAI,CAAC,CAAA;AAE/D,IAAM,WAAW,GAAG,aAAa,CAAsB,IAAI,CAAC,CAAA;AAE5D,IAAM,QAAQ,GAAG,cAAM,OAAA,UAAU,CAAC,gBAAgB,CAAC,EAA5B,CAA4B,CAAA;AAEnD,IAAM,QAAQ,GAAG,UAAC,KAAc;IAC9B,IAAM,GAAG,GAAG,UAAU,CAAC,WAAW,CAAC,CAAA;IACnC,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,aAAL,KAAK,cAAL,KAAK,GAAI,CAAC,CAAA;AACrC,CAAC,CAAA;AAED,IAAM,SAAS,GAAG,UAAC,MAAe;IAChC,IAAM,GAAG,GAAG,UAAU,CAAC,WAAW,CAAC,CAAA;IACnC,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAA;AAClC,CAAC,CAAA;AAED,IAAM,eAAe,GAAG,UAAC,YAAiB,EAAE,MAAc;;IACxD,IAAI,OAAO,CAAC,YAAY,CAAC;QAAE,OAAO,YAAY,CAAA;IAC9C,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,CAAC;QAC9B,OAAO,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAA;IACvD,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,OAAO;QAAE,OAAO,EAAE,CAAA;IAC9C,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,SAAS;QAAE,OAAO,IAAI,CAAA;IAClD,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,MAAM;QAAE,OAAO,EAAE,CAAA;IAC7C,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,UAAU;QAAE,OAAO,EAAE,CAAA;IACjD,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,QAAQ;QAAE,OAAO,CAAC,CAAA;IAC9C,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,QAAQ;QAAE,OAAO,EAAE,CAAA;IAC/C,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,IAAI,MAAK,QAAQ;QAAE,OAAO,EAAE,CAAA;IAC/C,OAAO,IAAI,CAAA;AACb,CAAC,CAAA;AAED,MAAM,CAAC,IAAM,SAAS,GAAsB,UAAC,KAAK;IAChD,IAAM,KAAK,GAAG,QAAQ,EAAc,CAAA;IACpC,IAAM,MAAM,GAAG,cAAc,EAAE,CAAA;IAC/B,OAAO,CACL,oBAAC,gBAAgB,CAAC,QAAQ,IAAC,KAAK,EAAE,EAAE,KAAK,OAAA,EAAE,MAAM,QAAA,EAAE,KAAK,OAAA,EAAE,IACvD,KAAK,CAAC,QAAQ,CACW,CAC7B,CAAA;AACH,CAAC,CAAA;AAED,SAAS,CAAC,IAAI,GAAG,UAAC,EAA2B;IAAzB,IAAA,QAAQ,cAAA,EAAK,KAAK,cAApB,YAAsB,CAAF;IAAY,OAAA,CAChD,oBAAC,WAAW,CAAC,QAAQ,IAAC,KAAK,EAAE,KAAK,IAAG,QAAQ,CAAwB,CACtE,CAAA;CAAA,CAAA;AAED,IAAM,UAAU,GAAG,cAAc,CAAC,UAAC,KAAU;IAC3C,IAAM,SAAS,GAAG,YAAY,CAAC,YAAY,CAAC,CAAA;IAC5C,OAAO,CACL,oBAAC,QAAQ,eACH,KAAK,IACT,SAAS,EAAE,GAAG,CAAC,UAAG,SAAS,iBAAc,EAAE,KAAK,CAAC,SAAS,CAAC,EAC3D,KAAK,eAAO,KAAK,CAAC,KAAK,KACvB,CACH,CAAA;AACH,CAAC,CAAQ,CAAA;AAET,SAAS,CAAC,UAAU,GAAG,UAAC,KAAK;;IAC3B,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAA;IACvB,IAAI,CAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,OAAO,MAAK,UAAU;QAAE,OAAO,IAAI,CAAA;IACpD,OAAO,oBAAC,UAAU,eAAK,KAAK,EAAI,CAAA;AAClC,CAAC,CAAA;AAED,IAAM,KAAK,GAAG,UAAC,KAAK;;IACV,IAAA,WAAW,GAAK,KAAK,YAAV,CAAU;IAC7B,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAM,SAAS,GAAG,YAAY,CAAC,YAAY,CAAC,CAAA;IAC5C,OAAO,CACL,yCAAU,KAAK,IAAE,SAAS,EAAE,UAAG,SAAS,WAAQ,KAC7C,MAAA,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAG,KAAK,CAAC,mCAAI,WAAI,KAAK,GAAG,CAAC,MAAG,CACpC,CACR,CAAA;AACH,CAAC,CAAA;AAED,SAAS,CAAC,KAAK,GAAG,KAAK,CAAA;AAEvB,IAAM,QAAQ,GAAG,UAAC,KAAK;;IACrB,IAAM,IAAI,GAAG,QAAQ,EAAE,CAAA;IACvB,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAM,SAAS,GAAG,YAAY,CAAC,YAAY,CAAC,CAAA;IAC5C,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAA;IACvB,IACE,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,OAAO,MAAK,UAAU;QACpC,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,OAAO,MAAK,UAAU,EACpC;QACA,OAAO,IAAI,CAAA;KACZ;IACD,OAAO,CACL,oBAAC,MAAM,aACL,IAAI,UACA,KAAK,IACT,QAAQ,EAAE,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,QAAQ,EAChC,SAAS,EAAE,GAAG,CAAC,UAAG,SAAS,cAAW,EAAE,KAAK,CAAC,SAAS,CAAC,EACxD,OAAO,EAAE,UAAC,CAAC;;YACT,IAAI,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ;gBAAE,OAAM;YACjC,IAAM,YAAY,GAAG,eAAe,CAAC,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC,MAAM,CAAC,CAAA;YACtE,IAAI,KAAK,CAAC,MAAM,KAAK,SAAS,EAAE;gBAC9B,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,OAAO,CAAC,YAAY,CAAC,CAAA;gBACnC,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,KAAK,mDAAG,CAAC,CAAC,CAAA;aACxB;iBAAM;gBACL,MAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,IAAI,mDAAG,YAAY,CAAC,CAAA;gBAClC,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,KAAK,mDAAG,CAAA,MAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,KAAK,0CAAE,MAAM,IAAG,CAAC,CAAC,CAAA;aACtD;YACD,MAAA,KAAK,CAAC,OAAO,sDAAG,CAAC,CAAC,CAAA;QACpB,CAAC,EACD,IAAI,EAAE,oBAAC,QAAQ,OAAG,KAEjB,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CACnB,CACV,CAAA;AACH,CAAC,CAAA;AAED,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAA;AAE7B,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC,UAAU,CAAC,UAAC,KAAK,EAAE,GAAG;;IAC7C,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAM,SAAS,GAAG,YAAY,CAAC,YAAY,CAAC,CAAA;IAC5C,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAA;IACvB,IAAI,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,OAAO,MAAK,UAAU;QAAE,OAAO,IAAI,CAAA;IACrD,OAAO,CACL,oBAAC,UAAU,eACL,KAAK,IACT,SAAS,EAAE,GAAG,CAAC,UAAG,SAAS,YAAS,EAAE,KAAK,CAAC,SAAS,CAAC,EACtD,GAAG,EAAE,GAAG,EACR,OAAO,EAAE,UAAC,CAAM;;YACd,IAAI,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ;gBAAE,OAAM;YACjC,CAAC,CAAC,eAAe,EAAE,CAAA;YACnB,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,MAAM,mDAAG,KAAK,CAAC,CAAA;YAC5B,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ,mDAAG,KAAK,CAAC,CAAA;YAC9B,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAA;aACjB;QACH,CAAC,IACD,CACH,CAAA;AACH,CAAC,CAAC,CAAA;AAEF,SAAS,CAAC,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC,UAAC,KAAK,EAAE,GAAG;;IAC/C,IAAM,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;IACnC,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAM,SAAS,GAAG,YAAY,CAAC,sBAAsB,CAAC,CAAA;IACtD,IAAI,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,OAAO,MAAK,UAAU;QAAE,OAAO,IAAI,CAAA;IACrD,OAAO,CACL,oBAAC,aAAa,eACR,KAAK,IACT,SAAS,EAAE,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC,SAAS,CAAC,EAC1C,GAAG,EAAE,GAAG,EACR,OAAO,EAAE,UAAC,CAAM;;YACd,IAAI,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ;gBAAE,OAAM;YACjC,CAAC,CAAC,eAAe,EAAE,CAAA;YACnB,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ,mDAAG,KAAK,CAAC,CAAA;YAC9B,MAAA,MAAA,KAAK,CAAC,KAAK,0CAAE,UAAU,mDAAG,KAAK,CAAC,CAAA;YAChC,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAA;aACjB;QACH,CAAC,IACD,CACH,CAAA;AACH,CAAC,CAAC,CAAA;AAEF,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC,UAAU,CAAC,UAAC,KAAK,EAAE,GAAG;;IAC7C,IAAM,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;IACnC,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAA;IACxB,IAAM,SAAS,GAAG,YAAY,CAAC,oBAAoB,CAAC,CAAA;IACpD,IAAI,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,OAAO,MAAK,UAAU;QAAE,OAAO,IAAI,CAAA;IACrD,OAAO,CACL,oBAAC,WAAW,eACN,KAAK,IACT,SAAS,EAAE,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC,SAAS,CAAC,EAC1C,GAAG,EAAE,GAAG,EACR,OAAO,EAAE,UAAC,CAAM;;YACd,IAAI,MAAA,KAAK,CAAC,KAAK,0CAAE,QAAQ;gBAAE,OAAM;YACjC,CAAC,CAAC,eAAe,EAAE,CAAA;YACnB,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,MAAM,CAAC,KAAK,CAAC,CAAA;YAC3B,MAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,KAAK,0CAAE,QAAQ,mDAAG,KAAK,CAAC,CAAA;YAC/B,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAA;aACjB;QACH,CAAC,IACD,CACH,CAAA;AACH,CAAC,CAAC,CAAA;AAEF,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAA;AAC7B,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAA;AAC7B,SAAS,CAAC,SAAS,GAAG,SAAS,CAAA;AAC/B,SAAS,CAAC,KAAK,GAAG,UAAC,MAAW;IAC5B,MAAM,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAA;IAC9B,MAAM,CAAC,UAAU,GAAG,SAAS,CAAC,UAAU,CAAA;IACxC,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAA;IACpC,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAA;IAChC,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAA;IACpC,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAA;IAChC,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAA;IACpC,MAAM,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAA;IACpC,MAAM,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,CAAA;IACtC,OAAO,MAAM,CAAA;AACf,CAAC,CAAA;AAED,eAAe,SAAS,CAAA\",\"sourcesContent\":[\"import React, { createContext, useContext } from 'react'\\nimport { Button } from '@arco-design/web-react'\\nimport { ButtonProps } from '@arco-design/web-react/es/button'\\nimport {\\n  IconPlus,\\n  IconDelete,\\n  IconMenu,\\n  IconCaretDown,\\n  IconCaretUp,\\n} from '@arco-design/web-react/icon'\\nimport type { IconProps as ArcoIconProps } from '@arco-design/web-react/icon'\\nimport { useField, useFieldSchema, Schema, JSXComponent } from '@formily/react'\\nimport { ArrayField } from '@formily/core'\\nimport { isValid } from '@formily/shared'\\nimport { SortableHandle } from 'react-sortable-hoc'\\nimport cls from 'classnames'\\n\\nimport './index.scss'\\nimport { usePrefixCls } from '../__builtins__'\\n\\ninterface IconProps extends ArcoIconProps {\\n  style?: React.CSSProperties\\n  spin?: boolean\\n}\\n\\nexport interface IArrayBaseAdditionProps extends ButtonProps {\\n  title?: string\\n  method?: 'push' | 'unshift'\\n}\\n\\nexport interface IArrayBaseProps {\\n  disabled?: boolean\\n  onAdd?: (index: number) => void\\n  onRemove?: (index: number) => void\\n  onMoveDown?: (index: number) => void\\n  onMoveUp?: (index: number) => void\\n}\\n\\nexport interface IArrayBaseContext {\\n  props: IArrayBaseProps\\n  field: ArrayField\\n  schema: Schema\\n}\\n\\nexport interface IArrayBaseItemProps {\\n  index: number\\n  style?: React.CSSProperties\\n  record: any\\n}\\n\\nexport type ArrayBaseMixins = {\\n  Addition?: React.FC<IArrayBaseAdditionProps>\\n  Remove?: React.FC<IconProps & { index?: number }>\\n  MoveUp?: React.FC<IconProps & { index?: number }>\\n  MoveDown?: React.FC<IconProps & { index?: number }>\\n  SortHandle?: React.FC<IconProps & { index?: number }>\\n  Index?: React.FC\\n  useArray?: () => IArrayBaseContext\\n  useIndex?: () => number\\n  useRecord?: (record?: number) => any\\n}\\n\\ntype ComposedArrayBase = React.FC<React.PropsWithChildren<IArrayBaseProps>> &\\n  ArrayBaseMixins & {\\n    Item: React.FC<IArrayBaseItemProps>\\n    mixin: <T extends JSXComponent>(target: T) => T & ArrayBaseMixins\\n  }\\n\\nconst ArrayBaseContext = createContext<IArrayBaseContext>(null)\\n\\nconst ItemContext = createContext<IArrayBaseItemProps>(null)\\n\\nconst useArray = () => useContext(ArrayBaseContext)\\n\\nconst useIndex = (index?: number) => {\\n  const ctx = useContext(ItemContext)\\n  return ctx ? ctx.index : index ?? 0\\n}\\n\\nconst useRecord = (record?: number) => {\\n  const ctx = useContext(ItemContext)\\n  return ctx ? ctx.record : record\\n}\\n\\nconst getDefaultValue = (defaultValue: any, schema: Schema) => {\\n  if (isValid(defaultValue)) return defaultValue\\n  if (Array.isArray(schema?.items))\\n    return getDefaultValue(defaultValue, schema.items[0])\\n  if (schema?.items?.type === 'array') return []\\n  if (schema?.items?.type === 'boolean') return true\\n  if (schema?.items?.type === 'date') return ''\\n  if (schema?.items?.type === 'datetime') return ''\\n  if (schema?.items?.type === 'number') return 0\\n  if (schema?.items?.type === 'object') return {}\\n  if (schema?.items?.type === 'string') return ''\\n  return null\\n}\\n\\nexport const ArrayBase: ComposedArrayBase = (props) => {\\n  const field = useField<ArrayField>()\\n  const schema = useFieldSchema()\\n  return (\\n    <ArrayBaseContext.Provider value={{ field, schema, props }}>\\n      {props.children}\\n    </ArrayBaseContext.Provider>\\n  )\\n}\\n\\nArrayBase.Item = ({ children, ...props }: any) => (\\n  <ItemContext.Provider value={props}>{children}</ItemContext.Provider>\\n)\\n\\nconst SortHandle = SortableHandle((props: any) => {\\n  const prefixCls = usePrefixCls('array-base')\\n  return (\\n    <IconMenu\\n      {...props}\\n      className={cls(`${prefixCls}-sort-handle`, props.className)}\\n      style={{ ...props.style }}\\n    />\\n  )\\n}) as any\\n\\nArrayBase.SortHandle = (props) => {\\n  const array = useArray()\\n  if (!array) return null\\n  if (array.field?.pattern !== 'editable') return null\\n  return <SortHandle {...props} />\\n}\\n\\nconst Index = (props) => {\\n  const { renderIndex } = props\\n  const index = useIndex()\\n  const prefixCls = usePrefixCls('array-base')\\n  return (\\n    <span {...props} className={`${prefixCls}-index`}>\\n      {renderIndex?.(index) ?? `#${index + 1}.`}\\n    </span>\\n  )\\n}\\n\\nArrayBase.Index = Index\\n\\nconst Addition = (props) => {\\n  const self = useField()\\n  const array = useArray()\\n  const prefixCls = usePrefixCls('array-base')\\n  if (!array) return null\\n  if (\\n    array?.field?.pattern !== 'editable' &&\\n    array?.field?.pattern !== 'disabled'\\n  ) {\\n    return null\\n  }\\n  return (\\n    <Button\\n      long\\n      {...props}\\n      disabled={array?.field?.disabled}\\n      className={cls(`${prefixCls}-addition`, props.className)}\\n      onClick={(e) => {\\n        if (array.props?.disabled) return\\n        const defaultValue = getDefaultValue(props.defaultValue, array.schema)\\n        if (props.method === 'unshift') {\\n          array?.field?.unshift(defaultValue)\\n          array.props?.onAdd?.(0)\\n        } else {\\n          array?.field?.push?.(defaultValue)\\n          array.props?.onAdd?.(array?.field?.value?.length - 1)\\n        }\\n        props.onClick?.(e)\\n      }}\\n      icon={<IconPlus />}\\n    >\\n      {self.title || props.title}\\n    </Button>\\n  )\\n}\\n\\nArrayBase.Addition = Addition\\n\\nArrayBase.Remove = React.forwardRef((props, ref) => {\\n  const index = useIndex()\\n  const array = useArray()\\n  const prefixCls = usePrefixCls('array-base')\\n  if (!array) return null\\n  if (array?.field?.pattern !== 'editable') return null\\n  return (\\n    <IconDelete\\n      {...props}\\n      className={cls(`${prefixCls}-remove`, props.className)}\\n      ref={ref}\\n      onClick={(e: any) => {\\n        if (array.props?.disabled) return\\n        e.stopPropagation()\\n        array.field?.remove?.(index)\\n        array.props?.onRemove?.(index)\\n        if (props.onClick) {\\n          props.onClick(e)\\n        }\\n      }}\\n    />\\n  )\\n})\\n\\nArrayBase.MoveDown = React.forwardRef((props, ref) => {\\n  const index = useIndex(props.index)\\n  const array = useArray()\\n  const prefixCls = usePrefixCls('array-base-move-down')\\n  if (array?.field?.pattern !== 'editable') return null\\n  return (\\n    <IconCaretDown\\n      {...props}\\n      className={cls(prefixCls, props.className)}\\n      ref={ref}\\n      onClick={(e: any) => {\\n        if (array.props?.disabled) return\\n        e.stopPropagation()\\n        array.field?.moveDown?.(index)\\n        array.props?.onMoveDown?.(index)\\n        if (props.onClick) {\\n          props.onClick(e)\\n        }\\n      }}\\n    />\\n  )\\n})\\n\\nArrayBase.MoveUp = React.forwardRef((props, ref) => {\\n  const index = useIndex(props.index)\\n  const array = useArray()\\n  const prefixCls = usePrefixCls('array-base-move-up')\\n  if (array?.field?.pattern !== 'editable') return null\\n  return (\\n    <IconCaretUp\\n      {...props}\\n      className={cls(prefixCls, props.className)}\\n      ref={ref}\\n      onClick={(e: any) => {\\n        if (array.props?.disabled) return\\n        e.stopPropagation()\\n        array?.field?.moveUp(index)\\n        array?.props?.onMoveUp?.(index)\\n        if (props.onClick) {\\n          props.onClick(e)\\n        }\\n      }}\\n    />\\n  )\\n})\\n\\nArrayBase.useArray = useArray\\nArrayBase.useIndex = useIndex\\nArrayBase.useRecord = useRecord\\nArrayBase.mixin = (target: any) => {\\n  target.Index = ArrayBase.Index\\n  target.SortHandle = ArrayBase.SortHandle\\n  target.Addition = ArrayBase.Addition\\n  target.Remove = ArrayBase.Remove\\n  target.MoveDown = ArrayBase.MoveDown\\n  target.MoveUp = ArrayBase.MoveUp\\n  target.useArray = ArrayBase.useArray\\n  target.useIndex = ArrayBase.useIndex\\n  target.useRecord = ArrayBase.useRecord\\n  return target\\n}\\n\\nexport default ArrayBase\\n\"]}"}
