{"version":3,"file":"password-strength.js","sourceRoot":"lib/","sources":["password/password-strength.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { Fragment } from 'react';\r\nimport { isFn } from '@formily/shared';\r\n\r\ntype ReactRenderPropsChildren<T = any> = React.ReactNode | ((props: T) => React.ReactElement);\r\n\r\ninterface IPasswordStrengthProps {\r\n  value?: React.ReactText;\r\n  children?: ReactRenderPropsChildren<number>;\r\n}\r\n\r\nconst isNum = function (c) {\r\n  return c >= 48 && c <= 57;\r\n};\r\nconst isLower = function (c) {\r\n  return c >= 97 && c <= 122;\r\n};\r\nconst isUpper = function (c) {\r\n  return c >= 65 && c <= 90;\r\n};\r\nconst isSymbol = function (c) {\r\n  return !(isLower(c) || isUpper(c) || isNum(c));\r\n};\r\nconst isLetter = function (c) {\r\n  return isLower(c) || isUpper(c);\r\n};\r\n\r\nconst getStrength = val => {\r\n  if (!val) {\r\n    return 0;\r\n  }\r\n  let num = 0;\r\n  let lower = 0;\r\n  let upper = 0;\r\n  let symbol = 0;\r\n  let MNS = 0;\r\n  let rep = 0;\r\n  let repC = 0;\r\n  let consecutive = 0;\r\n  let sequential = 0;\r\n  const len = () => num + lower + upper + symbol;\r\n  const callme = () => {\r\n    let re = num > 0 ? 1 : 0;\r\n    re += lower > 0 ? 1 : 0;\r\n    re += upper > 0 ? 1 : 0;\r\n    re += symbol > 0 ? 1 : 0;\r\n    if (re > 2 && len() >= 8) {\r\n      return re + 1;\r\n    } else {\r\n      return 0;\r\n    }\r\n  };\r\n  for (let i = 0; i < val.length; i++) {\r\n    const c = val.charCodeAt(i);\r\n    if (isNum(c)) {\r\n      num++;\r\n      if (i !== 0 && i !== val.length - 1) {\r\n        MNS++;\r\n      }\r\n      if (i > 0 && isNum(val.charCodeAt(i - 1))) {\r\n        consecutive++;\r\n      }\r\n    } else if (isLower(c)) {\r\n      lower++;\r\n      if (i > 0 && isLower(val.charCodeAt(i - 1))) {\r\n        consecutive++;\r\n      }\r\n    } else if (isUpper(c)) {\r\n      upper++;\r\n      if (i > 0 && isUpper(val.charCodeAt(i - 1))) {\r\n        consecutive++;\r\n      }\r\n    } else {\r\n      symbol++;\r\n      if (i !== 0 && i !== val.length - 1) {\r\n        MNS++;\r\n      }\r\n    }\r\n    let exists = false;\r\n    for (let j = 0; j < val.length; j++) {\r\n      if (val[i] === val[j] && i !== j) {\r\n        exists = true;\r\n        repC += Math.abs(val.length / (j - i));\r\n      }\r\n    }\r\n    if (exists) {\r\n      rep++;\r\n      const unique = val.length - rep;\r\n      repC = unique ? Math.ceil(repC / unique) : Math.ceil(repC);\r\n    }\r\n    if (i > 1) {\r\n      const last1 = val.charCodeAt(i - 1);\r\n      const last2 = val.charCodeAt(i - 2);\r\n      if (isLetter(c)) {\r\n        if (isLetter(last1) && isLetter(last2)) {\r\n          const v = val.toLowerCase();\r\n          const vi = v.charCodeAt(i);\r\n          const vi1 = v.charCodeAt(i - 1);\r\n          const vi2 = v.charCodeAt(i - 2);\r\n          if (vi - vi1 === vi1 - vi2 && Math.abs(vi - vi1) === 1) {\r\n            sequential++;\r\n          }\r\n        }\r\n      } else if (isNum(c)) {\r\n        if (isNum(last1) && isNum(last2)) {\r\n          if (c - last1 === last1 - last2 && Math.abs(c - last1) === 1) {\r\n            sequential++;\r\n          }\r\n        }\r\n      } else {\r\n        if (isSymbol(last1) && isSymbol(last2)) {\r\n          if (c - last1 === last1 - last2 && Math.abs(c - last1) === 1) {\r\n            sequential++;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  let sum = 0;\r\n  const length = len();\r\n  sum += 4 * length;\r\n  if (lower > 0) {\r\n    sum += 2 * (length - lower);\r\n  }\r\n  if (upper > 0) {\r\n    sum += 2 * (length - upper);\r\n  }\r\n  if (num !== length) {\r\n    sum += 4 * num;\r\n  }\r\n  sum += 6 * symbol;\r\n  sum += 2 * MNS;\r\n  sum += 2 * callme();\r\n  if (length === lower + upper) {\r\n    sum -= length;\r\n  }\r\n  if (length === num) {\r\n    sum -= num;\r\n  }\r\n  sum -= repC;\r\n  sum -= 2 * consecutive;\r\n  sum -= 3 * sequential;\r\n  sum = sum < 0 ? 0 : sum;\r\n  sum = sum > 100 ? 100 : sum;\r\n\r\n  if (sum >= 80) {\r\n    return 100;\r\n  } else if (sum >= 60) {\r\n    return 80;\r\n  } else if (sum >= 40) {\r\n    return 60;\r\n  } else if (sum >= 20) {\r\n    return 40;\r\n  } else {\r\n    return 20;\r\n  }\r\n};\r\n\r\nexport const PasswordStrength: React.FC<IPasswordStrengthProps> = props => {\r\n  if (isFn(props.children)) {\r\n    return props.children(getStrength(String(props.value)));\r\n  } else {\r\n    return <Fragment>{props.children}</Fragment>;\r\n  }\r\n};\r\n"]}